<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>TRI-AXIS v1.0.3 | å±…ä½ç›£æŸ»åŸ·è¡Œç«¯æœ«</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@900&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        /* 2026 CYBER-FINANCE AESTHETIC */
        :root {
            --bg: #030812; --card: rgba(12, 24, 40, 0.85); --border: rgba(50, 200, 255, 0.15);
            --cyan: #00f2ff; --gold: #ffd700; --red: #ff2a6d; --text: #e0f7fa;
            --safe-t: env(safe-area-inset-top); --safe-b: env(safe-area-inset-bottom);
        }
        * { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color:transparent; }
        body { background: var(--bg); color: var(--text); font-family: 'Inter', sans-serif; overflow-x:hidden; padding-bottom:100px; }
        
        /* HEADER */
        header { position:fixed; top:0; width:100%; padding:15px 20px; background:rgba(3,8,18,0.95); backdrop-filter:blur(20px); border-bottom:1px solid var(--border); z-index:100; display:flex; justify-content:space-between; align-items:center; padding-top:calc(15px + var(--safe-t)); }
        .brand { font-family:'Noto Serif JP'; font-weight:900; font-size:1.2rem; letter-spacing:0.1em; color:var(--cyan); }
        .psi-badge { background:rgba(0,242,255,0.1); border:1px solid var(--cyan); padding:4px 12px; border-radius:4px; font-family:'Noto Serif JP'; font-weight:900; }

        /* MAIN CONTAINER */
        main { padding:20px; padding-top:calc(70px + var(--safe-t)); max-width:600px; margin:0 auto; }
        
        /* CARD UI */
        .card { background:var(--card); border:1px solid var(--border); border-radius:16px; padding:20px; margin-bottom:20px; box-shadow:0 8px 32px rgba(0,0,0,0.3); }
        .card h2 { font-size:0.75rem; color:var(--gold); letter-spacing:0.15em; border-bottom:1px solid rgba(255,215,0,0.2); padding-bottom:8px; margin-bottom:15px; }
        
        /* INPUT GROUPS */
        .input-grid { display:grid; grid-template-columns: 1fr 1fr; gap:15px; }
        .group { margin-bottom:15px; }
        .group.full { grid-column: span 2; }
        label { display:block; font-size:0.65rem; color:#8daab3; margin-bottom:6px; font-weight:600; }
        label span { color:var(--cyan); font-size:0.6rem; opacity:0.8; margin-left:5px; font-weight:400; }
        input, select { width:100%; background:rgba(0,0,0,0.3); border:1px solid var(--border); border-radius:8px; padding:12px; color:#fff; font-size:0.95rem; outline:none; transition:0.3s; }
        input:focus, select:focus { border-color:var(--cyan); box-shadow:0 0 10px rgba(0,242,255,0.2); }
        
        /* HELP TEXT (åˆå¿ƒè€…å‘ã‘) */
        .help { font-size:0.6rem; color:#567; margin-top:4px; line-height:1.4; }

        /* EXECUTE BUTTON */
        .exec-btn { width:100%; padding:18px; background:linear-gradient(135deg, var(--cyan), #0088ff); border:none; border-radius:12px; color:#000; font-weight:900; letter-spacing:0.2em; font-size:1rem; cursor:pointer; box-shadow:0 0 20px rgba(0,242,255,0.3); margin-top:10px; position:relative; overflow:hidden; }
        .exec-btn::after { content:''; position:absolute; top:-50%; left:-50%; width:200%; height:200%; background:linear-gradient(45deg, transparent, rgba(255,255,255,0.3), transparent); transform:rotate(45deg); animation:shine 3s infinite; }
        @keyframes shine { 0% { left:-100%; } 100% { left:100%; } }

        /* RESULT VIEW (Initially Hidden) */
        #result-view { display:none; animation:fadeIn 0.5s ease; }
        @keyframes fadeIn { from{opacity:0;transform:translateY(10px);} to{opacity:1;transform:translateY(0);} }
        
        .score-box { text-align:center; padding:30px 0; border-bottom:1px solid var(--border); margin-bottom:20px; }
        .score-val { font-size:4rem; font-family:'Noto Serif JP'; font-weight:900; line-height:1; text-shadow:0 0 30px var(--cyan); }
        .score-rank { font-size:1.5rem; color:var(--gold); font-weight:900; }
        
        .interpreter-box { background:rgba(0,242,255,0.05); border-left:3px solid var(--cyan); padding:15px; margin-bottom:20px; border-radius:0 8px 8px 0; }
        .counter-box { background:rgba(255,42,109,0.05); border-left:3px solid var(--red); padding:15px; margin-bottom:20px; border-radius:0 8px 8px 0; }
        .box-title { font-size:0.7rem; font-weight:900; margin-bottom:8px; display:block; }

        /* CHARTS */
        .bar-wrap { margin-bottom:10px; }
        .bar-label { font-size:0.7rem; display:flex; justify-content:space-between; margin-bottom:4px; }
        .bar-bg { width:100%; height:8px; background:rgba(255,255,255,0.1); border-radius:4px; overflow:hidden; }
        .bar-fill { height:100%; background:var(--cyan); width:0%; transition:width 1s cubic-bezier(0.2,0.8,0.2,1); }

    </style>
</head>
<body>
    <header>
        <div class="brand">TRI-AXIS <span style="font-size:0.7em; opacity:0.7;">v1.0.3</span></div>
        <div class="psi-badge" id="header-psi">STANDBY</div>
    </header>

    <main>
        <section id="input-view">
            
            <div class="card">
                <h2>I. ç®¡ç†å“è³ªãƒ»ãƒ–ãƒ©ãƒ³ãƒ‰ç›£æŸ» (MGMT)</h2>
                <div class="group">
                    <label>ç®¡ç†ä¼šç¤¾å<span>(ãƒ†ã‚£ã‚¢è‡ªå‹•åˆ¤å®š)</span></label>
                    <select id="i-mgmt"></select> <div class="help">â€»ç®¡ç†ä¼šç¤¾ã®è³ªã¯ã€Œ10å¹´å¾Œã®ä¾¡æ ¼ä¸‹è½ã€ã¨ã€Œå»ºç‰©ã®å¯¿å‘½ã€ã‚’ç›´æ¥å·¦å³ã—ã¾ã™ã€‚</div>
                </div>
                <div class="group">
                    <label>ç‰©ä»¶ä¾¡æ ¼ (ä¸‡å††)</label>
                    <input type="number" id="i-price" value="6500">
                </div>
            </div>

            <div class="card">
                <h2>II. ç‰©ç†ãƒ»ç’°å¢ƒç›£æŸ» (HEDON)</h2>
                <div class="input-grid">
                    <div class="group">
                        <label>æ‰€åœ¨éšæ•°<span>(éŸ³éŸ¿å›æŠ˜)</span></label>
                        <input type="number" id="i-floor" value="10">
                    </div>
                    <div class="group">
                        <label>å‰é¢é“è·¯å¹… (m)<span>(ãƒ“ãƒ«é¢¨)</span></label>
                        <input type="number" id="i-road" value="8">
                    </div>
                </div>
                <div class="group">
                    <label>é–“å–ã‚Šå›³è§£æ (Simulated)</label>
                    <button type="button" style="width:100%; padding:10px; border:1px dashed var(--border); background:none; color:#8daab3; border-radius:8px;" onclick="alert('ç”»åƒè§£æã‚¨ãƒ³ã‚¸ãƒ³(Prototype)ã«æ¥ç¶š... è§£æã‚¹ã‚³ã‚¢: 72ç‚¹ (é€šé¢¨è‰¯å¥½)')">ğŸ“· é–“å–ã‚Šå›³ã‚’ã‚¹ã‚­ãƒ£ãƒ³</button>
                    <input type="hidden" id="i-plan" value="72">
                </div>
                <div class="help">â€»éšæ•°ãŒé«˜ã„ã»ã©ã€é®éŸ³å£ã‚’è¶Šãˆã¦åœ°ä¸Šã®é¨’éŸ³ãŒç›´æ¥å±Šãã€Œå›æŠ˜ç¾è±¡ã€ãŒç™ºç”Ÿã—ã¾ã™ã€‚</div>
            </div>

            <div class="card">
                <h2>III. æ³•çš„ãƒ»ç§»å‹•ç›£æŸ» (AEGIS/RAIL)</h2>
                <div class="group">
                    <label>è©³ç´°ä½æ‰€<span>(å¸‚å ´DNAè‡ªå‹•è§£æ±º)</span></label>
                    <input type="text" id="i-addr" placeholder="ä¾‹: æ±äº¬éƒ½æ¸¯åŒº..." value="æ±äº¬éƒ½æ¸¯åŒºèŠæµ¦">
                </div>
                <div class="input-grid">
                    <div class="group">
                        <label>æœ€å¯„ã‚Šé§…å</label>
                        <input type="text" id="i-station" value="ç”°ç”º">
                    </div>
                    <div class="group">
                        <label>è·¯ç·šå</label>
                        <input type="text" id="i-line" value="å±±æ‰‹ç·š">
                    </div>
                </div>
                <div class="group">
                    <label>ç”¨é€”åœ°åŸŸ<span>(æ—¥ç…§æ¨©ãƒªã‚¹ã‚¯)</span></label>
                    <select id="i-zone"></select> </div>
                <div class="group">
                    <label style="color:var(--gold);">[Pro] éš£åœ°APIé€£æº (Simulation)</label>
                    <select id="i-neighbor">
                        <option value="SAFE">æ¨™æº– (æ—¢å­˜ä½å®…ç­‰)</option>
                        <option value="PARKING">è­¦å‘Š: éš£åœ°ãŒé§è»Šå ´/ç©ºåœ° (é«˜å±¤åŒ–ãƒªã‚¹ã‚¯å¤§)</option>
                    </select>
                </div>
            </div>

            <div class="card">
                <h2>IV. è²¡å‹™ãƒ»é‡‘åˆ©ç›£æŸ» (LOGOS)</h2>
                <div class="input-grid">
                    <div class="group">
                        <label>ç’°å¢ƒæ€§èƒ½</label>
                        <select id="i-perf">
                            <option value="ZEH">ZEHæ°´æº– (4500ä¸‡æ§é™¤)</option>
                            <option value="BASE">çœã‚¨ãƒé©åˆ (3000ä¸‡æ§é™¤)</option>
                            <option value="LOW">ãã®ä»– (æ§é™¤ãªã—)</option>
                        </select>
                    </div>
                    <div class="group">
                        <label>å®Ÿè¡Œé‡‘åˆ© (%)</label>
                        <input type="number" id="i-rate" value="0.5" step="0.1">
                    </div>
                </div>
            </div>

            <button class="exec-btn" onclick="UI.execute()">ç›£æŸ»åŸ·è¡Œ (EXECUTE AUDIT)</button>
        </section>

        <section id="result-view">
            <div class="score-box">
                <div style="font-size:0.8rem; letter-spacing:0.2em; color:var(--cyan); margin-bottom:10px;">TOTAL PSI SCORE</div>
                <div class="score-val" id="r-psi">00.0</div>
                <div class="score-rank" id="r-rank">-</div>
            </div>

            <div class="interpreter-box">
                <span class="box-title" style="color:var(--cyan);">ğŸ”° è³¢è€…ã®åŠ©è¨€ (INTERPRETER)</span>
                <div id="r-advice" style="font-size:0.9rem; line-height:1.6;"></div>
            </div>

            <div class="counter-box">
                <span class="box-title" style="color:var(--red);">âš”ï¸ å¯¾æ¥­è€…ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ (WEAPON)</span>
                <div id="r-counter" style="font-size:0.85rem; line-height:1.6; font-style:italic;"></div>
                <button onclick="navigator.clipboard.writeText(document.getElementById('r-counter').innerText);alert('ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ')" style="margin-top:10px; background:rgba(255,42,109,0.2); border:none; color:var(--red); padding:5px 10px; border-radius:4px; font-size:0.7rem;">ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ã‚³ãƒ”ãƒ¼</button>
            </div>

            <div class="card">
                <h2>AUDIT LOGS (è©³ç´°ã‚¨ãƒ“ãƒ‡ãƒ³ã‚¹)</h2>
                
                <div class="bar-wrap">
                    <div class="bar-label"><span>HEDON (ç‰©ç†å¿«é©æ€§)</span><span id="s-h">0</span></div>
                    <div class="bar-bg"><div class="bar-fill" id="b-h"></div></div>
                    <div class="help" id="m-h"></div>
                </div>
                
                <div class="bar-wrap">
                    <div class="bar-label"><span>LOGOS (è³‡ç”£åˆç†æ€§)</span><span id="s-l">0</span></div>
                    <div class="bar-bg"><div class="bar-fill" id="b-l" style="background:var(--gold)"></div></div>
                    <div class="help" id="m-l"></div>
                </div>

                <div class="bar-wrap">
                    <div class="bar-label"><span>AEGIS (æ³•çš„å®ˆè­·)</span><span id="s-a">0</span></div>
                    <div class="bar-bg"><div class="bar-fill" id="b-a" style="background:var(--green)"></div></div>
                    <div class="help" id="m-a"></div>
                </div>
                
                <div style="margin-top:20px; padding-top:10px; border-top:1px solid rgba(255,255,255,0.1);">
                    <div class="bar-label"><span>10å¹´å¾Œ é‡å­äºˆæ¸¬ä¾¡æ ¼ (ä¸‹é™ã€œæœŸå¾…å€¤)</span></div>
                    <div style="font-size:1.2rem; font-family:'Noto Serif JP';"><span id="v-low" style="color:var(--red)">0</span> <span style="font-size:0.8rem">ä¸‡å††</span> ï½ <span id="v-exp">0</span> <span style="font-size:0.8rem">ä¸‡å††</span></div>
                </div>
            </div>

            <button class="exec-btn" style="background:transparent; border:1px solid var(--border); color:var(--text); box-shadow:none;" onclick="UI.reset()">å†ç›£æŸ» (RESET)</button>
        </section>
    </main>
        // Module 1, 2ã®ã‚¯ãƒ©ã‚¹ã¯æ—¢ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹å‰æã§ã€ã‚·ã‚¹ãƒ†ãƒ ã‚’èµ·å‹•ã—ã¾ã™
        
        const UI = {
            init() {
                // ç”¨é€”åœ°åŸŸãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ç”Ÿæˆ
                const zSelect = document.getElementById('i-zone');
                Object.keys(T_MASTERS.ZONES).forEach(key => {
                    const z = T_MASTERS.ZONES[key];
                    const opt = document.createElement('option');
                    opt.value = key;
                    opt.text = `${z.n} (æ—¥ç…§ä¿è­·:${Math.round(z.s*100)}%)`;
                    zSelect.add(opt);
                });

                // ç®¡ç†ä¼šç¤¾ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ç”Ÿæˆ
                const mSelect = document.getElementById('i-mgmt');
                T_MASTERS.MGMT.LIST.forEach(m => {
                    const opt = document.createElement('option');
                    opt.value = m.l; // åå‰ã‚’æ¸¡ã—ã¦è‡ªå‹•åˆ¤å®šã•ã›ã‚‹
                    opt.text = m.l;
                    mSelect.add(opt);
                });
            },

            execute() {
                // 1. å…¥åŠ›åé›†
                const inputs = {
                    mgmtName: document.getElementById('i-mgmt').value,
                    price: Number(document.getElementById('i-price').value),
                    floor: Number(document.getElementById('i-floor').value),
                    road: Number(document.getElementById('i-road').value),
                    addr: document.getElementById('i-addr').value,
                    station: document.getElementById('i-station').value,
                    line: document.getElementById('i-line').value,
                    zoneKey: document.getElementById('i-zone').value,
                    neighborType: document.getElementById('i-neighbor').value,
                    perf: document.getElementById('i-perf').value,
                    rate: Number(document.getElementById('i-rate').value),
                    planScore: Number(document.getElementById('i-plan').value)
                };

                // 2. çŸ¥èƒ½è§£æ±º (Resolver & Identification)
                const market = Resolver.getMarket(inputs.addr);
                const rail = Resolver.getRailTier(inputs.station, inputs.line);
                const mgmt = MgmtCore.resolveTier(inputs.mgmtName);
                const zone = T_MASTERS.ZONES[inputs.zoneKey];

                // 3. ä¸‰æ ¸æ¼”ç®— (Core Processing)
                // HEDON: ç‰©ç†
                const hRes = HedonCore.audit(inputs.floor, inputs.road, rail, inputs.planScore);
                
                // LOGOS: é‡‘è (ç®¡ç†ãƒ†ã‚£ã‚¢ã‚’æ¸¡ã™)
                const lRes = LogosCore.audit(inputs.price, mgmt, market, inputs.rate, inputs.perf);
                
                // AEGIS: å®ˆè­· (éš£åœ°APIã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ¸¡ã™)
                const neighborSim = { type: inputs.neighborType, safe: inputs.neighborType === 'SAFE' };
                const aRes = AegisCore.audit(zone, neighborSim, { risk: 0.1 /* åœ°ç›¤Sim */ });

                // 4. çµ±åˆÎ¨ã‚¹ã‚³ã‚¢æ¼”ç®— (Weighted Sum)
                // åˆå¿ƒè€…å‘ã‘ã«ã€HEDON(ç”Ÿæ´»)ã¨LOGOS(é‡‘)ã‚’é‡è¦–
                const psi = (hRes.score * 0.35) + (lRes.score * 0.40) + (aRes.score * 0.25);
                
                // 5. ç¿»è¨³ (Interpreter)
                const translation = Interpreter.translate(hRes, lRes, aRes, mgmt);

                // 6. ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
                this.render(psi, hRes, lRes, aRes, translation, mgmt);
            },

            render(psi, h, l, a, trans, mgmt) {
                // ãƒ“ãƒ¥ãƒ¼åˆ‡ã‚Šæ›¿ãˆ
                document.getElementById('input-view').style.display = 'none';
                document.getElementById('result-view').style.display = 'block';
                window.scrollTo(0,0);

                // ã‚¹ã‚³ã‚¢è¡¨ç¤º
                const psiVal = psi.toFixed(1);
                document.getElementById('r-psi').innerText = psiVal;
                document.getElementById('header-psi').innerText = `Î¨ ${psiVal}`;
                document.getElementById('r-psi').style.color = psi > 80 ? 'var(--cyan)' : (psi > 60 ? 'var(--gold)' : 'var(--red)');
                
                // ãƒ©ãƒ³ã‚¯åˆ¤å®š
                let rank = 'C';
                if(psi >= 85) rank = 'S (MASTERPIECE)';
                else if(psi >= 75) rank = 'A (EXCELLENT)';
                else if(psi >= 60) rank = 'B (STANDARD)';
                else if(psi >= 40) rank = 'C (CAUTION)';
                else rank = 'D (CRITICAL)';
                document.getElementById('r-rank').innerText = rank;

                // ç¿»è¨³ & ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼
                document.getElementById('r-advice').innerHTML = trans.advice.length ? 
                    trans.advice.map(t => `ãƒ»${t}`).join('<br>') : 
                    "ãƒ»å…¨ã¦ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒæ¥µã‚ã¦é«˜æ°´æº–ã§ã™ã€‚ç´ æ™´ã‚‰ã—ã„ç‰©ä»¶ã§ã™ã€‚";
                
                document.getElementById('r-counter').innerText = trans.counter.length ? 
                    trans.counter.join('\n\n') : 
                    "ã€Œç´ æ™´ã‚‰ã—ã„ç‰©ä»¶ã§ã™ã­ã€‚ç®¡ç†çŠ¶æ…‹ã‚‚ç«‹åœ°ã‚‚ç”³ã—åˆ†ã‚ã‚Šã¾ã›ã‚“ã€‚å‰å‘ãã«æ¤œè¨ã—ã¾ã™ã€‚ã€";

                // ãƒãƒ¼ãƒãƒ£ãƒ¼ãƒˆ & ãƒ­ã‚°
                const setBar = (id, val, msg) => {
                    document.getElementById(`s-${id}`).innerText = val;
                    document.getElementById(`b-${id}`).style.width = `${val}%`;
                    document.getElementById(`m-${id}`).innerText = msg;
                };

                setBar('h', h.score, `é¨’éŸ³:${h.noise}dB / é¢¨:${h.wind.l} / ç§»å‹•:${rail.n}`);
                setBar('l', l.score, `ç®¡ç†:${mgmt.n} / ç¨æ§é™¤:${l.taxCredit}ä¸‡ / ç ´ç¶»è€æ€§:${l.score > 70 ? 'é«˜' : 'ä½'}`);
                setBar('a', a.score, `ç”¨é€”:${zone.n} / æ—¥ç…§å–ªå¤±ç¢ºç‡:${a.shadowProb}% / ${a.neighborMsg}`);

                // é‡å­ä¾¡æ ¼
                document.getElementById('v-low').innerText = Math.round(l.lowPrice/10000).toLocaleString();
                document.getElementById('v-exp').innerText = Math.round(l.expPrice/10000).toLocaleString();
            },

            reset() {
                document.getElementById('result-view').style.display = 'none';
                document.getElementById('input-view').style.display = 'block';
                document.getElementById('header-psi').innerText = 'STANDBY';
                window.scrollTo(0,0);
            }
        };

        // åˆæœŸåŒ–
        window.onload = () => UI.init();
</body>
/**
 * TRI-AXIS v1.0.3 CORE INTELLIGENCE ENGINE
 * Copyright 2026 Y.T. & Gemini
 * * 3ã¤ã®å°‚é–€å®¶æ ¸ï¼ˆHEDON, LOGOS, AEGISï¼‰ã¨
 * ç¿»è¨³ãƒ»æˆ¦ç•¥æ ¸ï¼ˆINTERPRETERï¼‰ã‚’å®Ÿè£…
 */

// ==========================================
// 1. ç®¡ç†å“è³ªãƒ»éšå±¤åŒå®šæ ¸ (MGMT-ID Core)
// ==========================================
class MgmtCore {
    static resolveTier(name) {
        // ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãƒ»ãƒãƒƒã‚·ãƒ¥ãƒãƒƒãƒ— (2026å¹´æœ€æ–°ç‰ˆ)
        const KW = {
            S: /ä¸‰äº•|ä¸‰è±|åœ°æ‰€|ä½å‹|é‡æ‘|æ±äº¬å»ºç‰©/, 
            A: /æ±æ€¥|å¤§äº¬|é•·è°·å·¥|ç©æ°´|å¤§å’Œ|è¿‘é‰„|äº¬ç‹|é˜ªæ€¥/,
            B: /ãƒã‚¦ã‚ºã‚¤ãƒ³ã‚°|åˆäººç¤¾|æ—¥æœ¬ç·åˆ|JS|ç©´å¹|ä¼Šè—¤å¿ |æ—¥é‰„|åŒæ—¥|å•†äº‹/,
            D: /è‡ªä¸»|ãªã—|è©²å½“ãªã—/
        };
        
        // ãƒ†ã‚£ã‚¢åˆ¤å®š & ä¿‚æ•°å‡ºåŠ›
        // p: è³‡ç”£ç¶­æŒãƒ—ãƒ¬ãƒŸã‚¢ãƒ , d: åŠ£åŒ–æŠ‘åˆ¶ä¿‚æ•°, v: ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£æŠ‘åˆ¶
        if (KW.S.test(name)) return { t:'S', p:1.12, d:0.85, v:0.70, n:"è²¡é–¥ãƒ»è¶…å¤§æ‰‹" };
        if (KW.A.test(name)) return { t:'A', p:1.05, d:0.95, v:0.85, n:"å¤§æ‰‹ãƒ»é›»é‰„ç³»" };
        if (KW.B.test(name)) return { t:'B', p:1.00, d:1.00, v:1.00, n:"ç‹¬ç«‹ãƒ»ä¸­å …" };
        if (KW.D.test(name)) return { t:'D', p:0.75, d:1.50, v:1.40, n:"è‡ªä¸»ç®¡ç†ãƒ»ä¸å…¨" };
        
        // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: Cãƒ†ã‚£ã‚¢ (ä¸­å°ãƒ»åœ°å ´)
        return { t:'C', p:0.92, d:1.20, v:1.15, n:"ä¸­å°ãƒ»ãã®ä»–" };
    }
}

// ==========================================
// 2. ç‰©ç†ãƒ»ç”Ÿæ´»ç’°å¢ƒç›£æŸ»æ ¸ (HEDON Core)
// ==========================================
class HedonCore {
    /**
     * @param {number} floor - æ‰€åœ¨éš
     * @param {number} roadW - é“è·¯å¹…å“¡(m)
     * @param {object} rail - é‰„é“ãƒ†ã‚£ã‚¢æƒ…å ±
     * @param {object} plan - é–“å–ã‚Šè§£æã‚¹ã‚³ã‚¢ (0-100)
     */
    static audit(floor, roadW, rail, planScore) {
        // A. éŸ³éŸ¿å›æŠ˜ãƒ»é¨’éŸ³ç›£æŸ»
        // L = L_ref - DistAtten + Diffraction(Floor)
        const baseNoise = 75; // å¹¹ç·šé“è·¯åŸºæº–
        const distAtten = 10 * Math.log10(Math.max(floor*3, 10)); // è·é›¢æ¸›è¡°
        const diffraction = floor > 3 ? (floor - 3) * 0.7 : 0; // å›æŠ˜è£œæ­£ (ä¸Šå±¤éšã»ã©å£ã®åŠ¹æœãŒè–„ã‚Œã‚‹)
        const finalNoise = Math.round(baseNoise - distAtten + diffraction);
        
        // B. æµä½“å‰¥é›¢ãƒ»ãƒ“ãƒ«é¢¨ç›£æŸ» (H/Wæ¯”)
        const height = floor * 3;
        const hwRatio = height / Math.max(roadW, 4);
        let windRisk = { s:0, l:"ä½", msg:"å¹³ç©" };
        if (hwRatio > 2.5) windRisk = { s:30, l:"æ¥µå¤§", msg:"ã€è­¦å‘Šã€‘å‰¥é›¢æµç™ºç”Ÿé ˜åŸŸã€‚ãƒãƒ«ã‚³ãƒ‹ãƒ¼åˆ©ç”¨å›°é›£ã€‚" };
        else if (hwRatio > 1.5) windRisk = { s:10, l:"ä¸­", msg:"ä¹±æµç™ºç”Ÿã®å¯èƒ½æ€§ã‚ã‚Šã€‚" };

        // C. ç§»å‹•ãƒ»ç’°å¢ƒã‚¨ãƒ³ãƒˆãƒ­ãƒ”ãƒ¼ (æ··é›‘ x æ™‚é–“)
        // rail.s (ã‚¹ãƒˆãƒ¬ã‚¹ä¿‚æ•°) * å¾…ã¡æ™‚é–“è£œæ­£
        const entropy = rail.s * 10 + (windRisk.s / 2);

        // HEDONã‚¹ã‚³ã‚¢çµ±åˆ (100ç‚¹æº€ç‚¹)
        // é–“å–ã‚Šã‚¹ã‚³ã‚¢ã€é¨’éŸ³ã€é¢¨ã€ç§»å‹•ã‚¹ãƒˆãƒ¬ã‚¹ã‹ã‚‰æ¸›ç‚¹æ–¹å¼
        let score = 100 
            - (Math.max(0, finalNoise - 45) * 1.5) // é¨’éŸ³ãƒšãƒŠãƒ«ãƒ†ã‚£
            - windRisk.s 
            - (entropy * 0.5)
            + ((planScore - 50) * 0.5); // é–“å–ã‚Šãƒœãƒ¼ãƒŠã‚¹/ãƒšãƒŠãƒ«ãƒ†ã‚£

        return { score: Math.max(0, score.toFixed(1)), noise: finalNoise, wind: windRisk, entropy };
    }
}

// ==========================================
// 3. é‡‘èãƒ»é‡å­ç›£æŸ»æ ¸ (LOGOS Core)
// ==========================================
class LogosCore {
    /**
     * @param {number} price - ä¾¡æ ¼(ä¸‡å††)
     * @param {object} mgmt - ç®¡ç†ãƒ†ã‚£ã‚¢æƒ…å ±
     * @param {object} market - å¸‚å ´DNA (CAGR, Turnover)
     * @param {number} rate - å®Ÿè¡Œé‡‘åˆ©(%)
     * @param {string} perf - ç’°å¢ƒæ€§èƒ½ (ZEH/BASE/LOW)
     */
    static audit(price, mgmt, market, rate, perf) {
        // A. 2026å¹´ è²¡å‹™è«¸å…ƒ
        const feeRate = 0.075; // è«¸è²»ç”¨
        const totalCost = price * (1 + feeRate);
        const limit = perf === 'ZEH' ? 4500 : (perf === 'BASE' ? 3000 : 0);
        const taxCredit = Math.min(price, limit) * 0.007 * 13; // 13å¹´æ§é™¤

        // B. é‡å­è³‡ç”£ä¾¡å€¤äºˆæ¸¬ (Geometric Brownian Motion)
        // ç®¡ç†ä¼šç¤¾ã®è³ª(v)ãŒãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£(sigma)ã‚’æŠ‘åˆ¶ã¾ãŸã¯å¢—å¹…ã™ã‚‹
        const years = 10;
        const mu = market.c; // CAGR
        const sigmaBase = 0.15; 
        const sigma = sigmaBase * mgmt.v; // èª¿æ•´å¾Œãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£
        
        // æœŸå¾…å€¤ E[P]
        const expPrice = price * Math.exp(mu * years);
        
        // 95%ä¿¡é ¼åŒºé–“ ä¸‹é™å€¤ (Risk Floor)
        // P_low = P0 * exp((Î¼ - 0.5Ïƒ^2)t - 1.96Ïƒâˆšt)
        const drift = (mu - 0.5 * Math.pow(sigma, 2)) * years;
        const shock = 1.96 * sigma * Math.sqrt(years);
        const lowPrice = price * Math.exp(drift - shock) * mgmt.d; // ç‰©ç†åŠ£åŒ–(d)ã‚‚ä¹—ç®—

        // C. é‡‘åˆ©ã‚¹ãƒˆãƒ¬ã‚¹ãƒ†ã‚¹ãƒˆ (+2%, +4% ã‚·ãƒŠãƒªã‚ª)
        const calcPay = (rAdd) => {
            const r = (rate + rAdd) / 100 / 12;
            const n = 420; // 35å¹´
            return Math.round(totalCost * 10000 * r * Math.pow(1+r,n) / (Math.pow(1+r,n)-1));
        };

        // LOGOSã‚¹ã‚³ã‚¢çµ±åˆ (è³‡ç”£ç¶­æŒç‡ + CFå®‰å…¨æ€§)
        const ltvRaw = totalCost / price;
        const safetyMargin = (lowPrice - (price * 0.7)) / 100; // 10å¹´å¾Œæ®‹å‚µå‰²ã‚Œãƒªã‚¹ã‚¯
        let score = (expPrice / price * 50) + (safetyMargin > 0 ? 30 : 0) + (mgmt.t === 'S' ? 20 : 0);

        return { 
            score: Math.min(100, Math.max(0, score.toFixed(1))),
            expPrice: Math.round(expPrice), 
            lowPrice: Math.round(lowPrice), 
            taxCredit: Math.round(taxCredit),
            stress: { now: calcPay(0), plus2: calcPay(2.0), plus4: calcPay(4.0) }
        };
    }
}

// ==========================================
// 4. å®ˆè­·ãƒ»éš£åœ°ç›£æŸ»æ ¸ (AEGIS Core)
// ==========================================
class AegisCore {
    /**
     * @param {object} zone - ç”¨é€”åœ°åŸŸãƒã‚¹ã‚¿
     * @param {object} neighbor - éš£åœ°APIã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³çµæœ
     * @param {object} geo - åœ°ç›¤ãƒªã‚¹ã‚¯æƒ…å ±
     */
    static audit(zone, neighbor, geo) {
        // A. æ³•çš„æ—¥ç…§å–ªå¤±ãƒªã‚¹ã‚¯ (s-Index)
        let shadowRisk = (1 - zone.s) * 100;
        
        // B. éš£åœ°APIèåˆ (Data Fusion)
        // éš£åœ°ãŒã€Œé§è»Šå ´(Parking)ã€ã‹ã¤ã€Œå•†æ¥­åœ°åŸŸ(C)ã€ãªã‚‰ãƒªã‚¹ã‚¯æ¥µå¤§åŒ–
        let neighborWarning = "";
        if (neighbor.type === 'PARKING' && zone.r > 0.6) {
            shadowRisk = 95; // å¼·åˆ¶ä¸Šæ›¸ã
            neighborWarning = "ã€è­¦å‘Šã€‘éš£æ¥åœ°ãŒé–‹ç™ºå®¹æ˜“ãªä½åˆ©ç”¨åœ°ã§ã™ã€‚é«˜å±¤åŒ–ãƒªã‚¹ã‚¯æ¥µå¤§ã€‚";
        }

        // C. åœ°ç›¤ãƒ»ç½å®³ãƒªã‚¹ã‚¯
        const disasterScore = (1 - geo.risk) * 100;

        // AEGISã‚¹ã‚³ã‚¢çµ±åˆ
        let score = (zone.s * 40) + (disasterScore * 0.4) + (neighbor.safe ? 20 : 0);

        return { 
            score: Math.min(100, Math.max(0, score.toFixed(1))), 
            shadowProb: Math.round(shadowRisk), 
            neighborMsg: neighborWarning 
        };
    }
}

// ==========================================
// 5. åˆå¿ƒè€…ç¿»è¨³ãƒ»æˆ¦ç•¥æ ¸ (INTERPRETER Core)
// ==========================================
class Interpreter {
    static translate(h, l, a, mgmt) {
        let advice = [];
        let counter = [];

        // HEDONç¿»è¨³
        if (h.score < 60) {
            advice.push(`ç‰©ç†çš„ã«éé…·ã§ã™ã€‚${h.noise}dBã®é¨’éŸ³ã¯ã€Œçª“ã‚’é–‹ã‘ã‚‰ã‚Œãªã„ã€ãƒ¬ãƒ™ãƒ«ã€‚ãƒ“ãƒ«é¢¨ã‚‚æ‡¸å¿µã•ã‚Œã¾ã™ã€‚`);
            counter.push(`ã€Œé¨’éŸ³äºˆæ¸¬å€¤ãŒ${h.noise}dBã‚’è¶…ãˆã¦ã„ã¾ã™ãŒã€ã‚µãƒƒã‚·ã®é®éŸ³ç­‰ç´šã¯T-3ä»¥ä¸Šã§ã™ã‹ï¼Ÿã¾ãŸã€ã“ã®H/Wæ¯”ã§ã®é¢¨ç’°å¢ƒè©•ä¾¡æ›¸ã‚’è¦‹ã›ã¦ãã ã•ã„ã€`);
        }

        // LOGOSç¿»è¨³
        if (l.lowPrice < l.expPrice * 0.7) {
            advice.push(`10å¹´å¾Œã®è³‡ç”£ä¾¡å€¤ãŒã€ãƒ­ãƒ¼ãƒ³æ®‹é«˜ã‚’å‰²ã‚Šè¾¼ã‚€ã€Œã‚ªãƒ¼ãƒãƒ¼ãƒ­ãƒ¼ãƒ³ã€ã®ãƒªã‚¹ã‚¯ãŒé«˜ã„ã§ã™ã€‚ç®¡ç†ä¼šç¤¾ãƒ†ã‚£ã‚¢(${mgmt.t})ã®å½±éŸ¿ãŒå‡ºã¦ã„ã¾ã™ã€‚`);
            counter.push(`ã€Œç®¡ç†ä¼šç¤¾ãŒ${mgmt.t}ãƒ©ãƒ³ã‚¯ã§ã‚ã‚Šã€å°†æ¥ã®ä¿®ç¹•ãƒªã‚¹ã‚¯ã¨è³‡ç”£ãƒœãƒ©ãƒ†ã‚£ãƒªãƒ†ã‚£ãŒé«˜ã„ã¨ç®—å‡ºã•ã‚Œã¾ã—ãŸã€‚ã“ã®ãƒªã‚¹ã‚¯åˆ†ã€ä¾¡æ ¼ã«ç¹”ã‚Šè¾¼ã¾ã‚Œã¦ã„ã¾ã™ã‹ï¼Ÿã€`);
        } else {
            advice.push(`è³‡ç”£æ€§ã¯å …ç‰¢ã§ã™ã€‚${mgmt.n}ç³»ã®ç®¡ç†ã«ã‚ˆã‚Šã€è³‡ç”£ä¾¡å€¤ã®ä¸‹è½ãŒå¼·åŠ›ã«æŠ‘åˆ¶ã•ã‚Œã¦ã„ã¾ã™ã€‚`);
        }

        // AEGISç¿»è¨³
        if (a.shadowProb > 80) {
            advice.push(`ä»Šã¯æ—¥å½“ãŸã‚ŠãŒè‰¯ã„ã§ã™ãŒã€ãã‚Œã¯ã€Œå¹»ã€ã§ã™ã€‚éš£åœ°ã«å»ºç‰©ãŒå»ºã¤æ³•çš„ç¢ºç‡ãŒ${a.shadowProb}%ã‚‚ã‚ã‚Šã¾ã™ã€‚`);
            counter.push(`ã€Œéš£åœ°ã®åˆ©ç”¨çŠ¶æ³ã¨ç”¨é€”åœ°åŸŸã‹ã‚‰è¦‹ã¦ã€æ•°å¹´ä»¥å†…ã®çœºæœ›å–ªå¤±ã¯ç¢ºå®Ÿã§ã™ã€‚çœºæœ›ãƒ—ãƒ¬ãƒŸã‚¢ãƒ ã‚’æ’é™¤ã—ãŸä¾¡æ ¼ã§ã®äº¤æ¸‰ã‚’å¸Œæœ›ã—ã¾ã™ã€`);
        }

        return { advice, counter };
    }
}
/**
 * TRI-AXIS v1.0.3 MASTER DNA REPOSITORY
 * å…¨å›½å¯¾å¿œãƒ»åœ§ç¸®å‹è¾æ›¸ãƒ‡ãƒ¼ã‚¿ (2026 Edition)
 */
const T_MASTERS = {
    // ==========================================
    // 1. ç®¡ç†å“è³ªãƒ»ãƒ–ãƒ©ãƒ³ãƒ‰ãƒã‚¹ã‚¿ (MGMT-DNA)
    // p: è³‡ç”£ç¶­æŒè£œæ­£, d: åŠ£åŒ–æŠ‘åˆ¶ä¿‚æ•° (å°ã•ã„ã»ã©å„ªç§€)
    // ==========================================
    MGMT: {
        TIERS: {
            S: { p: 1.12, d: 0.85, n: "ã€Sã€‘è²¡é–¥ãƒ»è¶…å¤§æ‰‹ãƒ‡ãƒ™ãƒ­ãƒƒãƒ‘ãƒ¼ç³»", desc: "è³‡ç”£ä¾¡å€¤ã®çµ¶å¯¾é˜²è¡›ç·šã€‚åŠ£åŒ–ã‚’15%é…å»¶ã€‚" },
            A: { p: 1.05, d: 0.95, n: "ã€Aã€‘å¤§æ‰‹åºƒåŸŸãƒ»é›»é‰„ç³»", desc: "ä¿¡é ¼ã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã€‚å®‰å®šã—ãŸä¿®ç¹•è¨ˆç”»ã€‚" },
            B: { p: 1.00, d: 1.00, n: "ã€Bã€‘ç‹¬ç«‹ç³»å¤§æ‰‹ãƒ»å®ŸåŠ›æ´¾", desc: "æ¨™æº–çš„ãªç®¡ç†å“è³ªã€‚çµ„åˆã®è³ªã«ä¾å­˜ã€‚" },
            C: { p: 0.92, d: 1.20, n: "ã€Cã€‘ä¸­å°ç‹¬ç«‹ãƒ»åœ°å ´ç³»", desc: "ã‚³ã‚¹ãƒˆé‡è¦–ã€‚å°†æ¥ã®ä¸€æ™‚é‡‘ãƒªã‚¹ã‚¯ã‚ã‚Šã€‚" },
            D: { p: 0.75, d: 1.50, n: "ã€Dã€‘è‡ªä¸»ç®¡ç†ãƒ»ç®¡ç†ä¸å…¨", desc: "ã€è‡´å‘½çš„ã€‘ãƒ­ãƒ¼ãƒ³å¯©æŸ»ãƒ»ãƒªã‚»ãƒ¼ãƒ«ã«é‡å¤§ãªæ”¯éšœã€‚" }
        },
        // UIãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ç”Ÿæˆç”¨ãƒªã‚¹ãƒˆ
        LIST: [
            { v: "S", l: "ä¸‰äº•ãƒ»ä¸‰è±ãƒ»ä½å‹ãƒ»é‡æ‘ (è²¡é–¥ç³»)" },
            { v: "A", l: "æ±æ€¥ãƒ»å¤§äº¬ãƒ»é•·è°·å·¥ãƒ»æ±äº¬å»ºç‰© (å¤§æ‰‹ç³»)" },
            { v: "B", l: "æ—¥æœ¬ãƒã‚¦ã‚ºã‚¤ãƒ³ã‚°ãƒ»åˆäººç¤¾ãƒ»æ—¥é‰„ (ç‹¬ç«‹å¤§æ‰‹)" },
            { v: "C", l: "ãã®ä»–ã®ä¸­å°ç®¡ç†ä¼šç¤¾" },
            { v: "D", l: "è‡ªä¸»ç®¡ç† / ç®¡ç†ä¼šç¤¾ãªã—" }
        ]
    },

    // ==========================================
    // 2. ç”¨é€”åœ°åŸŸãƒ»æ³•çš„å®ˆè­·ãƒã‚¹ã‚¿ (ZONES)
    // s: æ—¥ç…§ä¿è­·æŒ‡æ•° (é«˜ã„ã»ã©å®ˆã‚‰ã‚Œã‚‹), r: æ³•çš„ãƒªã‚¹ã‚¯
    // ==========================================
    ZONES: {
        L1: { n: "ç¬¬ä¸€ç¨®ä½å±¤ä½å±…å°‚ç”¨", s: 0.95, r: 0.05, d: "ã€è–åŸŸã€‘ä½å±¤ä½ç’°å¢ƒã®çµ¶å¯¾ä¿è­·ã€‚" },
        L2: { n: "ç¬¬äºŒç¨®ä½å±¤ä½å±…å°‚ç”¨", s: 0.90, r: 0.10, d: "ä½å±¤ç’°å¢ƒï¼‹å°è¦æ¨¡åº—èˆ—ã€‚" },
        M1: { n: "ç¬¬ä¸€ç¨®ä¸­é«˜å±¤ä½å±…å°‚ç”¨", s: 0.70, r: 0.35, d: "å°†æ¥ã®ãƒãƒ³ã‚·ãƒ§ãƒ³å»ºè¨­ãƒªã‚¹ã‚¯ã‚ã‚Šã€‚" },
        M2: { n: "ç¬¬äºŒç¨®ä¸­é«˜å±¤ä½å±…å°‚ç”¨", s: 0.65, r: 0.40, d: "åˆ©ä¾¿æ–½è¨­ã¨ã®æ··åœ¨ã‚¨ãƒªã‚¢ã€‚" },
        H1: { n: "ç¬¬ä¸€ç¨®ä½å±…", s: 0.50, r: 0.60, d: "æ—¥ç…§ä¿è­·ã¯é™å®šçš„ã€‚å¤§è¦æ¨¡å»ºç‰©å¯ã€‚" },
        H2: { n: "ç¬¬äºŒç¨®ä½å±…", s: 0.45, r: 0.65, d: "ãƒ‘ãƒãƒ³ã‚³åº—ç­‰ã‚‚å¯ã€‚ç’°å¢ƒå¤‰åŒ–ãƒªã‚¹ã‚¯ä¸­ã€‚" },
        JH: { n: "æº–ä½å±…", s: 0.40, r: 0.70, d: "å¹¹ç·šé“è·¯æ²¿ã„ã€‚é¨’éŸ³ãƒ»æ’ã‚¬ã‚¹æ‡¸å¿µã€‚" },
        NC: { n: "è¿‘éš£å•†æ¥­", s: 0.30, r: 0.85, d: "æ—¥ç…§æ¨©ä¿è­·å¼±ã€‚å•†æ¥­æ–½è¨­éš£æ¥ãƒªã‚¹ã‚¯ã€‚" },
        C:  { n: "å•†æ¥­åœ°åŸŸ", s: 0.15, r: 0.95, d: "ã€è­¦å‘Šã€‘éš£åœ°è¶…é«˜å±¤åŒ–ã¯åˆæ³•çš„æ¨©åˆ©ã€‚" },
        JI: { n: "æº–å·¥æ¥­", s: 0.30, r: 0.80, d: "å·¥å ´è·¡åœ°ãƒªã‚¹ã‚¯ã€‚åœŸå£Œæ±šæŸ“ãƒ»é¨’éŸ³æ³¨æ„ã€‚" },
        I:  { n: "å·¥æ¥­", s: 0.10, r: 0.90, d: "ä½å®…ä¸é©ã€‚ç’°å¢ƒæ‚ªåŒ–å—å¿ç¾©å‹™ã‚ã‚Šã€‚" },
        // ç”°åœ’ä½å±…(DEN), å·¥æ¥­å°‚ç”¨(IS)ç­‰ã¯ç‰¹æ®Šã‚±ãƒ¼ã‚¹ã¨ã—ã¦å‡¦ç†
    },

    // ==========================================
    // 3. å…¨å›½å¸‚å ´ãƒ»åœ°ä¾¡DNA (MARKET-DNA)
    // c: CAGR(æˆé•·ç‡), t: Turnover(æµå‹•æ€§æ—¥æ•°)
    // ==========================================
    MARKET: {
        // åœ°åŸŸãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ
        REGIONS: {
            KANTO: { c: 0.015, t: 70 }, KANSAI: { c: 0.012, t: 80 }, CHUBU: { c: 0.010, t: 85 },
            TOHOKU: { c: 0.002, t: 110 }, KYUSHU: { c: 0.008, t: 90 }, HOKKAIDO: { c: 0.005, t: 100 },
            CHUSHIKOKU: { c: 0.001, t: 120 }
        },
        // éƒ½å¸‚ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ (2026å¹´ æˆé•·æ¥µ)
        CITIES: {
            "æ¸¯åŒº": {c:0.048, t:28}, "åƒä»£ç”°åŒº": {c:0.045, t:30}, "ä¸­å¤®åŒº": {c:0.042, t:32},
            "æ¸‹è°·åŒº": {c:0.038, t:35}, "æ–°å®¿åŒº": {c:0.035, t:38}, "æ–‡äº¬åŒº": {c:0.030, t:45},
            "æ­¦è”µé‡å¸‚": {c:0.028, t:40}, "æ¨ªæµœå¸‚è¥¿åŒº": {c:0.025, t:45}, "å·å´å¸‚ä¸­åŸåŒº": {c:0.028, t:42},
            "å¤§é˜ªå¸‚åŒ—åŒº": {c:0.032, t:40}, "å¤§é˜ªå¸‚ä¸­å¤®åŒº": {c:0.030, t:42}, "äº¬éƒ½å¸‚ä¸­äº¬åŒº": {c:0.025, t:50},
            "åå¤å±‹å¸‚ä¸­åŒº": {c:0.022, t:55}, "ç¦å²¡å¸‚ä¸­å¤®åŒº": {c:0.038, t:30}, "æœ­å¹Œå¸‚ä¸­å¤®åŒº": {c:0.020, t:60}
        }
    },

    // ==========================================
    // 4. å…¨å›½é‰„é“ãƒ»ç§»å‹•DNA (RAIL-AXIS)
    // ãƒ†ã‚£ã‚¢å®šç¾©ã¨æ­£è¦è¡¨ç¾ãƒ‘ã‚¿ãƒ¼ãƒ³
    // ==========================================
    RAIL: {
        TIERS: {
            S: { p: 1.15, s: 1.5, n: "ã€Sã€‘è¶…åºƒåŸŸåŸºå¹¹è»¸ (å±±æ‰‹ãƒ»å¾¡å ‚ç­‹ç­‰)" },
            A: { p: 1.08, s: 1.2, n: "ã€Aã€‘åºƒåŸŸå„ªç­‰è»¸ (æ±æ¨ªãƒ»æ—¥æ¯”è°·ç­‰)" },
            B: { p: 1.02, s: 0.9, n: "ã€Bã€‘ä¸»è¦é€šå‹¤è»¸ (JRå¹¹ç·šãƒ»ç§é‰„æœ¬ç·š)" },
            C: { p: 0.95, s: 0.7, n: "ã€Cã€‘åœ°åŸŸé€£çµè»¸ (éƒŠå¤–ãƒ»æ”¯ç·š)" },
            D: { p: 0.85, s: 0.4, n: "ã€Dã€‘ãƒ­ãƒ¼ã‚«ãƒ«ãƒ»ç‰¹å®šè»¸" }
        },
        PATTERNS: [
            // S-Tier
            { r: /å±±æ‰‹|éŠ€åº§|ä¸¸ãƒå†…|åƒä»£ç”°|å¾¡å ‚ç­‹|æ±æµ·é“æ–°å¹¹ç·š/, t: "S" },
            // A-Tier
            { r: /æ±æ¨ª|ç”°åœ’éƒ½å¸‚|æ—¥æ¯”è°·|åŠè”µé–€|å—åŒ—|ä¸‰ç”°|å¤§æ±Ÿæˆ¸|æµ…è‰|æ–°å®¿|å‰¯éƒ½å¿ƒ|æœ‰æ¥½ç”º|äº¬æµœæ±åŒ—|ç·æ­¦ç·šå¿«é€Ÿ|æ±æµ·é“ç·š|é˜ªæ€¥ç¥æˆ¸|é˜ªæ€¥äº¬éƒ½|äº¬éƒ½ç·š|çƒä¸¸|ç©ºæ¸¯ç·š|ä¸ƒéšˆ/, t: "A" },
            // B-Tier
            { r: /ä¸­å¤®|ç·æ­¦|åŸ¼äº¬|é«˜å´|å®‡éƒ½å®®|å¸¸ç£|äº¬è‘‰|å°ç”°æ€¥|äº¬ç‹|è¥¿æ­¦æ± è¢‹|æ±æ­¦æ±ä¸Š|äº¬æ€¥æœ¬ç·š|ç›¸é‰„|ã¤ãã°|åé‰„åå¤å±‹|æ±å±±|ååŸ|è¿‘é‰„å¥ˆè‰¯|é˜ªç¥|å—æµ·æœ¬ç·š|äº¬é˜ªæœ¬ç·š|ç¥æˆ¸å¸‚å–¶|å¤§é˜ªç’°çŠ¶|æ±è±Š|å—åŒ—ç·š\(æœ­\)|ä»™å°å¸‚åœ°/, t: "B" },
            // C-Tier (Default fallback logic applied for others)
            { r: /è¥¿æ­¦æ–°å®¿|é‡ç”°|ä¼Šå‹¢å´|äº¬æˆ|å¤šæ‘©|å—æ­¦|æ­¦è”µé‡|æ¨ªæµœ|ç›¸æ¨¡|é¶´èˆ|æ¡œé€š|å››ã¤æ©‹|åƒæ—¥å‰|è°·ç”º|å ºç­‹|é•·å €|ä»Šé‡Œ|é˜ªæ€¥å®å¡š|äº¬é˜ªå®‡æ²»|è¥¿é‰„/, t: "C" }
        ]
    },

    // ==========================================
    // 5. 2026å¹´ è²¡å‹™ãƒ»ç‰©ç†å®šæ•° (CORE-CONST)
    // ==========================================
    CONST: {
        FINANCE: { 
            ZEH_LIMIT: 4500, BASE_LIMIT: 3000, 
            STRESS_RATE_LOW: 2.0, STRESS_RATE_HIGH: 4.0 
        },
        PHYSICS: { 
            NOISE_REF: 75, // å¹¹ç·šé“è·¯é¨’éŸ³dB
            WIND_CRITICAL: 2.5 // H/Wæ¯”é™ç•Œå€¤
        }
    }
};

/**
 * ãƒã‚¹ã‚¿è§£æ±ºãƒ˜ãƒ«ãƒ‘ãƒ¼ (Data Resolver)
 */
const Resolver = {
    // ä½æ‰€ã‹ã‚‰å¸‚å ´ãƒ‡ãƒ¼ã‚¿ã‚’è§£æ±º
    getMarket(addr) {
        // éƒ½å¸‚ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ç¢ºèª
        for (const [city, data] of Object.entries(T_MASTERS.MARKET.CITIES)) {
            if (addr.includes(city)) return data;
        }
        // åœ°æ–¹åˆ¤å®š
        if (addr.match(/æ±äº¬|ç¥å¥ˆå·|åƒè‘‰|åŸ¼ç‰|èŒ¨åŸ|æ ƒæœ¨|ç¾¤é¦¬/)) return T_MASTERS.MARKET.REGIONS.KANTO;
        if (addr.match(/å¤§é˜ª|äº¬éƒ½|å…µåº«|æ»‹è³€|å¥ˆè‰¯|å’Œæ­Œå±±/)) return T_MASTERS.MARKET.REGIONS.KANSAI;
        if (addr.match(/æ„›çŸ¥|å²é˜œ|é™å²¡|ä¸‰é‡/)) return T_MASTERS.MARKET.REGIONS.CHUBU;
        if (addr.match(/ç¦å²¡|ä½è³€|é•·å´|ç†Šæœ¬|å¤§åˆ†|å®®å´|é¹¿å…å³¶/)) return T_MASTERS.MARKET.REGIONS.KYUSHU;
        if (addr.match(/åŒ—æµ·é“/)) return T_MASTERS.MARKET.REGIONS.HOKKAIDO;
        // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ
        return T_MASTERS.MARKET.REGIONS.KANTO;
    },
    // è·¯ç·šåã‹ã‚‰ãƒ†ã‚£ã‚¢ã‚’è§£æ±º
    getRailTier(stationName, lineName) {
        const target = (lineName + stationName); // é§…åã‚‚å«ã‚ã¦æ¤œç´¢
        const match = T_MASTERS.RAIL.PATTERNS.find(p => p.r.test(target));
        return match ? T_MASTERS.RAIL.TIERS[match.t] : T_MASTERS.RAIL.TIERS.C;
    }
};
    <script>
</html>